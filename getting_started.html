<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Getting Started &mdash; Saleae 1.0.6 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Launching the Logic 2 Software and Starting the Socket Interface" href="launching_logic2.html" />
    <link rel="prev" title="Saleae Logic 2 Automation Interface Documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Saleae
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installing-the-python-automation-api-package">Installing the Python Automation API package</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launching-logic2">Launching Logic2</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-python-automation-api">Using the Python Automation API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#finding-the-serial-number-device-id-of-a-device">Finding the Serial Number (Device Id) of a Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="#versioning">Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="#headless-on-linux">Headless on Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#failure-during-install-due-to-modulenotfounderror-no-module-named-hatchling">Failure during install due to <code class="code docutils literal notranslate"><span class="pre">ModuleNotFoundError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">'hatchling'</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#failure-when-importing-saleae-automation-saleae-grpc">Failure when importing saleae.automation / saleae.grpc</a></li>
<li class="toctree-l3"><a class="reference internal" href="#can-t-find-a-solution">Can’t find a solution?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="launching_logic2.html">Launching the Logic 2 Software and Starting the Socket Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="automation.html">Automation API</a></li>
<li class="toctree-l1"><a class="reference internal" href="errors.html">Errors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Saleae</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Getting Started</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/getting_started.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this heading"></a></h1>
<section id="installing-the-python-automation-api-package">
<h2>Installing the Python Automation API package<a class="headerlink" href="#installing-the-python-automation-api-package" title="Permalink to this heading"></a></h2>
<p>To get started, you will need the latest build of the Logic 2 Software (2.4.0+), the logic2-automation (1.0.0+) python package, and Python 3.8, 3.9, or 3.10.</p>
<p>First, let’s install the logic2-automation package:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install logic2-automation
</pre></div>
</div>
</section>
<section id="launching-logic2">
<h2>Launching Logic2<a class="headerlink" href="#launching-logic2" title="Permalink to this heading"></a></h2>
<p>The automation interface can be enabled in the software UI. Open the preferences dialog from the main menu, and scroll to the bottom.</p>
<img alt="_images/server_ui.png" src="_images/server_ui.png" />
<p>When the checkbox is checked, the automation server will start running in the Logic 2 software on the default port, 10430.</p>
</section>
<section id="using-the-python-automation-api">
<h2>Using the Python Automation API<a class="headerlink" href="#using-the-python-automation-api" title="Permalink to this heading"></a></h2>
<p>Next, let’s run a simple example. You don’t need to have a device connected for this.
This example uses a demo device, if you would like to use a connected device follow the
steps <a class="reference internal" href="#device-serial-number"><span class="std std-ref">here</span></a>
to find your device’s serial number and replace the demo value in the example.</p>
<p>Create a new python file called <code class="code docutils literal notranslate"><span class="pre">saleae_example.py</span></code>, and paste in these contents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">saleae</span> <span class="kn">import</span> <span class="n">automation</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Connect to the running Logic 2 Application on port `10430`.</span>
<span class="c1"># Alternatively you can use automation.Manager.launch() to launch a new Logic 2 process - see</span>
<span class="c1"># the API documentation for more details.</span>
<span class="c1"># Using the `with` statement will automatically call manager.close() when exiting the scope. If you</span>
<span class="c1"># want to use `automation.Manager` outside of a `with` block, you will need to call `manager.close()` manually.</span>
<span class="k">with</span> <span class="n">automation</span><span class="o">.</span><span class="n">Manager</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">10430</span><span class="p">)</span> <span class="k">as</span> <span class="n">manager</span><span class="p">:</span>

    <span class="c1"># Configure the capturing device to record on digital channels 0, 1, 2, and 3,</span>
    <span class="c1"># with a sampling rate of 10 MSa/s, and a logic level of 3.3V.</span>
    <span class="c1"># The settings chosen here will depend on your device&#39;s capabilities and what</span>
    <span class="c1"># you can configure in the Logic 2 UI.</span>
    <span class="n">device_configuration</span> <span class="o">=</span> <span class="n">automation</span><span class="o">.</span><span class="n">LogicDeviceConfiguration</span><span class="p">(</span>
        <span class="n">enabled_digital_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="n">digital_sample_rate</span><span class="o">=</span><span class="mi">10_000_000</span><span class="p">,</span>
        <span class="n">digital_threshold_volts</span><span class="o">=</span><span class="mf">3.3</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Record 5 seconds of data before stopping the capture</span>
    <span class="n">capture_configuration</span> <span class="o">=</span> <span class="n">automation</span><span class="o">.</span><span class="n">CaptureConfiguration</span><span class="p">(</span>
        <span class="n">capture_mode</span><span class="o">=</span><span class="n">automation</span><span class="o">.</span><span class="n">TimedCaptureMode</span><span class="p">(</span><span class="n">duration_seconds</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Start a capture - the capture will be automatically closed when leaving the `with` block</span>
    <span class="c1"># Note: The serial number &#39;F4241&#39; is for the Logic Pro 16 demo device.</span>
    <span class="c1">#       To use a real device, you can:</span>
    <span class="c1">#         1. Omit the `device_id` argument. Logic 2 will choose the first real (non-simulated) device.</span>
    <span class="c1">#         2. Use the serial number for your device. See the &quot;Finding the Serial Number</span>
    <span class="c1">#            of a Device&quot; section for information on finding your device&#39;s serial number.</span>
    <span class="k">with</span> <span class="n">manager</span><span class="o">.</span><span class="n">start_capture</span><span class="p">(</span>
            <span class="n">device_id</span><span class="o">=</span><span class="s1">&#39;F4241&#39;</span><span class="p">,</span>
            <span class="n">device_configuration</span><span class="o">=</span><span class="n">device_configuration</span><span class="p">,</span>
            <span class="n">capture_configuration</span><span class="o">=</span><span class="n">capture_configuration</span><span class="p">)</span> <span class="k">as</span> <span class="n">capture</span><span class="p">:</span>

        <span class="c1"># Wait until the capture has finished</span>
        <span class="c1"># This will take about 5 seconds because we are using a timed capture mode</span>
        <span class="n">capture</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>

        <span class="c1"># Add an analyzer to the capture</span>
        <span class="c1"># Note: The simulator output is not actual SPI data</span>
        <span class="n">spi_analyzer</span> <span class="o">=</span> <span class="n">capture</span><span class="o">.</span><span class="n">add_analyzer</span><span class="p">(</span><span class="s1">&#39;SPI&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Test Analyzer&#39;</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="p">{</span>
            <span class="s1">&#39;MISO&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;Clock&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;Enable&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s1">&#39;Bits per Transfer&#39;</span><span class="p">:</span> <span class="s1">&#39;8 Bits per Transfer (Standard)&#39;</span>
        <span class="p">})</span>

        <span class="c1"># Store output in a timestamped directory</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="sa">f</span><span class="s1">&#39;output-</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">_%H-%M-%S&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">output_dir</span><span class="p">)</span>

        <span class="c1"># Export analyzer data to a CSV file</span>
        <span class="n">analyzer_export_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">&#39;spi_export.csv&#39;</span><span class="p">)</span>
        <span class="n">capture</span><span class="o">.</span><span class="n">export_data_table</span><span class="p">(</span>
            <span class="n">filepath</span><span class="o">=</span><span class="n">analyzer_export_filepath</span><span class="p">,</span>
            <span class="n">analyzers</span><span class="o">=</span><span class="p">[</span><span class="n">spi_analyzer</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Export raw digital data to a CSV file</span>
        <span class="n">capture</span><span class="o">.</span><span class="n">export_raw_data_csv</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">digital_channels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

        <span class="c1"># Finally, save the capture to a file</span>
        <span class="n">capture_filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">&#39;example_capture.sal&#39;</span><span class="p">)</span>
        <span class="n">capture</span><span class="o">.</span><span class="n">save_capture</span><span class="p">(</span><span class="n">filepath</span><span class="o">=</span><span class="n">capture_filepath</span><span class="p">)</span>

</pre></div>
</div>
<p>With the software is running, and the automation interface enabled (as shown above), run the script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python saleae_example.py
</pre></div>
</div>
<p>There you have it! Take a look at the documentation for Manager and Capture to see how the functionality all works!</p>
<p>Also, for most automated applications, you won’t want to start the software manually. See <a class="reference internal" href="launching_logic2.html#launching-and-starting-socket"><span class="std std-ref">this section</span></a> for more information about different ways to launch the Logic software.</p>
</section>
<section id="finding-the-serial-number-device-id-of-a-device">
<span id="device-serial-number"></span><h2>Finding the Serial Number (Device Id) of a Device<a class="headerlink" href="#finding-the-serial-number-device-id-of-a-device" title="Permalink to this heading"></a></h2>
<p>To find the serial number of a connected device, open capture info sidebar and click the device dropdown in the top right:</p>
<img alt="_images/device_info.png" src="_images/device_info.png" />
<p>If the device you want the serial number for is not selected, select it. Then click “Device Info” - this will open a popup with information about your device, including its serial number.</p>
<img alt="_images/device_serial.png" src="_images/device_serial.png" />
<p>You can copy the serial number from here and use it in your Python script where a “device_id” is required.</p>
</section>
<section id="versioning">
<h2>Versioning<a class="headerlink" href="#versioning" title="Permalink to this heading"></a></h2>
<p>The <cite>saleae.proto</cite> file contains a version (<cite>major.minor.patch</cite>). It can be found in the file header, and also in the
<cite>ThisApiVersion</cite> enum.</p>
<p>When generating language bindings, you can get the version of the .proto that was used through the protobuf <cite>ThisApiVersion</cite> enum - <cite>THIS_API_VERSION_MAJOR</cite>, <cite>THIS_API_VERSION_MINOR</cite>, and <cite>THIS_API_VERSION_PATCH</cite>.</p>
<p>The version of the .proto file that the server is using can be retrieved using the <cite>GetAppInfo</cite> gRPC method, or the <cite>Manager.get_app_info()</cite> call in the Python API.</p>
<ul class="simple">
<li><p>For a given major version, the API strives to be forward and backwards compatible.</p></li>
<li><p>The major version will change when:</p>
<ul>
<li><p>There are any breaking changes</p></li>
</ul>
</li>
<li><p>The minor version will change when:</p>
<ul>
<li><p>New features are added</p></li>
<li><p>Additions are made to the existing API</p></li>
</ul>
</li>
<li><p>The patch version will change when:</p>
<ul>
<li><p>There are fixes to the API</p></li>
</ul>
</li>
</ul>
<p>When implementing a client that uses the gRPC API directly, it is recommended to always retrieve the api version via GetAppInfo to validate that the major version is the same, and that the minor version is not older than the client. The Python API does this automatically on creation of the Manager object.</p>
</section>
<section id="headless-on-linux">
<h2>Headless on Linux<a class="headerlink" href="#headless-on-linux" title="Permalink to this heading"></a></h2>
<p>We do not currently support running Logic 2 in a headless mode, but it is possible to run Logic 2 in headless Linux environments using XVFB.</p>
<p>The specifics for your environment may differ, but on Ubuntu 20.04 we have had success with the following setup.</p>
<p>Install xvfb and other depdendencies:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo apt install xvfb libatk1.0-0 libatk-bridge2.0-0 libgtk-3-0 libgbm1
</pre></div>
</div>
<p>Run Logic 2:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>xvfb-run path/to/Logic-2.4.0.AppImage
</pre></div>
</div>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this heading"></a></h2>
<section id="failure-during-install-due-to-modulenotfounderror-no-module-named-hatchling">
<h3>Failure during install due to <code class="code docutils literal notranslate"><span class="pre">ModuleNotFoundError:</span> <span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span> <span class="pre">'hatchling'</span></code><a class="headerlink" href="#failure-during-install-due-to-modulenotfounderror-no-module-named-hatchling" title="Permalink to this heading"></a></h3>
<p><code class="code docutils literal notranslate"><span class="pre">logic2-automation</span></code> is packaged as a source distribution and built locally on install using <code class="code docutils literal notranslate"><span class="pre">hatchling</span></code>. If you are building without isolation (for example, <code class="code docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">--no-build-isolation</span> <span class="pre">logic2-automation</span></code>) and you don’t have <code class="code docutils literal notranslate"><span class="pre">hatchling</span></code> installed, you will see this error. If you can’t install with isolation, you can install <code class="code docutils literal notranslate"><span class="pre">hatchling</span></code> (example: <code class="code docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">hatchling</span></code>) in your local environment to resolve the issue.</p>
</section>
<section id="failure-when-importing-saleae-automation-saleae-grpc">
<h3>Failure when importing saleae.automation / saleae.grpc<a class="headerlink" href="#failure-when-importing-saleae-automation-saleae-grpc" title="Permalink to this heading"></a></h3>
<p>If you see an error like this when you import from <code class="code docutils literal notranslate"><span class="pre">saleae.automation</span></code>, it may be a protobuf/grpc version incompatibility. This can happen when you upgrade protobuf and/or grpc after installing <code class="code docutils literal notranslate"><span class="pre">logic2-automation</span></code>.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>TypeError: Descriptors cannot not be created directly.
If this call came from a _pb2.py file, your generated code is out of date and must be regenerated with protoc &gt;= 3.19.0.
If you cannot immediately regenerate your protos, some other possible workarounds are:
 1. Downgrade the protobuf package to 3.20.x or lower.
 2. Set PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=python (but this will use pure-Python parsing and will be much slower).
</pre></div>
</div>
<p>You can regenerate the protobuf/grpc files by reinstalling <code class="code docutils literal notranslate"><span class="pre">logic2-automation</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip install --force-reinstall logic2-automation
</pre></div>
</div>
</section>
<section id="can-t-find-a-solution">
<h3>Can’t find a solution?<a class="headerlink" href="#can-t-find-a-solution" title="Permalink to this heading"></a></h3>
<p>Contact us at <a class="reference external" href="https://contact.saleae.com/hc/en-us/requests/new">https://contact.saleae.com/hc/en-us/requests/new</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Saleae Logic 2 Automation Interface Documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="launching_logic2.html" class="btn btn-neutral float-right" title="Launching the Logic 2 Software and Starting the Socket Interface" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Saleae Inc.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>